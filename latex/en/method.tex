
\chapter{Method}

To find properties mapped on the protein primary structure which are possibly important for prediction of protein-ligand binding sites, statistical analysis will have the crucial role. It is a great way to explore the big amounts of accessible data and it can potentially help to discover underlying patterns and draw inferences from the data.

This chapter describes the method that was used to analyse the \textit{statistical significance} of the properties and to distinguish the ones that stand out in the known protein-ligand binding sites.

\section{Hypothesis testing}

Hypothesis testing is a method of statistical inference. Its goal is to infer properties of a \textit{statistical population}, a set of similar items or events. To give an example of a population, in this work, two populations will be compared: we take values of a property for all the amino acids and compare the ones in binding sites and outside of binding sites.

A dataset usually contains a subset collected from a larger population, rather than the whole population. This subset is called a \textit{statistical sample}. It should represent the population well and be unbiased.

A \textit{hypothesis} makes a statement about an unknown population parameter. In a hypothesis testing problem, an experimenter states two complementary hypotheses: the \textit{null hypothesis} and the \textit{alternative hypothesis}, denoted by $H_{0}$ and $H_{1}$, respectively. The null hypothesis comprises a subset of possible parameters and the alternative hypothesis comprises the supplement, so that all the possible parameters are covered.

In a hypothesis testing problem, an experimenter should come to one of the conclusions: to either accept $H_{0}$, or to reject $H_{0}$ and accept $H_{1}$.

To decide which one of two complementary hypotheses is true, an experimenter employes a suitable \textit{hypothesis test}. A hypothesis test is a rule that specifies for which sample values the $H_{0}$ is accepted as true and for which sample values it is rejected, and therefore $H_{1}$ is accepted as true. A hypothesis test is usually specified in terms of a test statistic (i.g. a function of the sample). \cite{casella}

As one may expect, the tests are not error-proof and a mistake can be made in the decision of whether to accept or reject the null hypothesis. There are two types of errors in hypothesis testing, commonly known as \textit{Type I Error} and \textit{Type II Error}. The test has made a Type I Error if it incorrectly rejects a true null hypothesis. If, on the other hand, a null hypothesis is accepted and it is not true, a Type II Error has been made. Both situations are depicted in the Table~\ref{tab:hypothesis_testing_errors}. The ideal test would have both error probabilities equal to zero. However, in most cases it is not possible to make both error probabilities arbitrarily small for a fixed sample size. \cite{casella}

\begin{table}[!htbp]
\centering
\renewcommand{\arraystretch}{2.5}
\begin{tabular}{l|l|c|c|}
\multicolumn{2}{c}{}&\multicolumn{2}{c}{\begin{Large}Prediction \end{Large}}\\
\cline{3-4}
\multicolumn{2}{c|}{}&Accept $H_{0}$&Reject $H_{0}$\\
\cline{2-4}
\multirow{2}{*}{\begin{Large}Truth\end{Large}}& \textbf{$H_{0}$} & \shortstack{Correct\\(true positive)} & \shortstack{\textbf{Type I Error}\\(false positive)}\\
\cline{2-4}
& \textbf{$H_{1}$} & \shortstack{\textbf{Type II Error}\\(false negative)} & \shortstack{Correct\\(true negative)} \\
\cline{2-4}
\end{tabular}
\caption{Type I and II Error in hypothesis testing.}\label{tab:hypothesis_testing_errors}
\end{table}

To control statistical significance of the result, a study defines a threshold called \textit{significance level}, a constant denoted by $\alpha$. It is the probability  of making a Type I Error, in other words, the probability that the study rejects the null hypothesis when it is true.

One way to report the result of the test would be simply to tell whether the null hypothesis was accepted or rejected at the given significance level. However, most researchers choose to report a certain kind of test statistic (function of a sample $X$), the so-called \textit{p-value}.
Smaller values of $p(X)$ give stronger evidence for rejecting the null hypothesis. The null hypothesis is rejected when $p(X) \leq \alpha$. Hence, we are able to determine the smallest significance level at which the hypothesis would be accepted/rejected. P-value gives us an idea of how strongly the data contradict the null hypothesis and furthermore, it allows other researchers to make a decision according to the significance level of their choice. \cite{sham_purcell, casella, lehmann}

It is suggested that the significance level for a study is set prior to any data collection. \cite{neynman_pearson}
The typical choices are $\alpha =$ 0.01, 0.05 or 0.10. \cite{casella}

Be aware that by fixing the significance level of the test, the experimenter is controlling only the Type I Error probabilities. The probability of the Type II Error is subject to factors beyond the experimenter's control, such as the accuracy and completeness of the data. \cite{sham_purcell}

Let's suppose an experimenter has a research hypothesis that he or she hopes to prove, but does not want to risk accepting it without convincing data support. In this case, the test should be set up in such a way that the research hypothesis corresponds to the alternative hypothesis, not the null hypothesis. By specifying a small significance level $\alpha$, the experimenter thus controls the probability of the Type I Error. In other words, the probability of accepting the research hypothesis when in is not true would be $\alpha$ at most. \cite{casella}



\subsection{Welsch's test}

Welsch's unequal variances t-test, or Welsch's test in short, is a two-sample hypothesis test used to test whether two populations have different central tendencies (mean or median). The decision is made based on the samples from the two populations. It is a more robust alteration of the well-known Student's t-test. \cite{welsch}

TODO assumption normality

The problem of the Student's t-test is that it performs badly when the variances of the two compared populations are unequal. Both Type I and Type II Errors are negatively affected when the assumption of the equal variances is violated. The unequal variances can be less problematic if sample sizes are similar, but in practice, that is not always the case. \cite{ruxton}

Unlike Student's t-test, Welsch's test does not have the assumption of the equal variances. It performs well when the samples have unequal variances; furthermore, it can be used even if the samples have unequal sizes.\cite{derrick}

Some researchers tend to pre-test for variance equality by a preliminary test of variances (.....) and then choose whether to use Student's t-test or Welsch's t-test. However, although this approach can persist in textbooks and software packages, it is not recommended. As a preliminary test itself is subject to Type I and II errors, this two-stage procedure would not protect the significance level and could lead to incorrect decisions. We should be aware of the fact that even if the test suggested that the samples variances are nearly equal, it would not mean that the whole population variances could not differ to a larger extent. \cite{zimmerman} Some researchers may try to make the significance level of a preliminary test more strict, so that they could be more confident about the choice of the subsequent test; however, as the significance level decreases, the performance of the compound test paradoxically gets worse. According to the article \cite{zimmerman} TODO, a higher Type I error rate of the test of variances improves the performance of the compound test. This shows that using the preliminary test is in principle wrong.

Welsch's test should be used whenever the researcher is not sure that the variances are truly equal. Ruxton \cite{ruxton} TODO even suggests the routine use of Welsch's test. When the sample sizes and variances are equal, both tests perform similarly. When dealing with unequal variances and unequal sample sizes, Welsch's test is more robust than Student's t-test and the Type I Error rate does not deviate far from the nominal value \cite{derrick}. Hence, Welsch's test can be applied without any significant disadvantages to Student's t-test.

\subsection{Fisher's exact test}

\subsection{Chi-squared test}




\section{Data}
plus significance level, null hypothesis, alternative hypothesis


\section{Implementation in Python}


